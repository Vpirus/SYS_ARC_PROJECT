<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AgriGo Admin Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&family=Roboto:wght@400;500&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" type="text/css" href="/templates/admin/admin.css" />
</head>
<body>
    <div class="overlay" id="overlay"></div>
    <div class="container">
        <!-- Sidebar (unchanged) -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img src="/templates/images/logo.png" alt="AgriGo Logo" class="logo" />
                <h2>AgriGo</h2>
                <button class="menu-toggle" id="menu-toggle" aria-label="Toggle menu"><i class="fas fa-chevron-left"></i></button>
            </div>
            <div class="sidebar-menu">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-tab="dashboard">
                            <i class="fas fa-tachometer-alt"></i> <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/templates/admin/user-management.html" class="nav-link" data-tab="users">
                            <i class="fas fa-users"></i> <span>User Management</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/templates/admin/products.html" class="nav-link" data-tab="products">
                            <i class="fas fa-shopping-basket"></i> <span>Products</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/templates/admin/orders.html" class="nav-link" data-tab="orders">
                            <i class="fas fa-clipboard-list"></i> <span>Orders</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/templates/admin/payments.html" class="nav-link" data-tab="payments">
                            <i class="fas fa-credit-card"></i> <span>Payments</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/templates/admin/reviews.html" class="nav-link" data-tab="reviews">
                            <i class="fas fa-comment"></i> <span>Reviews</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/templates/admin/analytics.html" class="nav-link" data-tab="analytics">
                            <i class="fas fa-chart-line"></i> <span>Analytics</span>
                        </a>
                    </li>
                </ul>
                <div class="sidebar-toggle-mobile">
                    <i class="fas fa-times"></i>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="main-content">
            <!-- Header -->
            <div class="header">
                <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Mobile menu"><i class="fas fa-bars"></i></button>
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search dashboard..." aria-label="Search" />
                </div>
                <div class="header-actions">
                    <div class="notification" id="notificationIcon">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count">5</span>
                        <div class="notification-dropdown" id="notificationDropdown">
                            <h3>Notifications</h3>
                            <ul class="notification-list">
                                <li class="notification-item">
                                    <div class="notification-icon new"><i class="fas fa-user-plus"></i></div>
                                    <div class="notification-content">
                                        <p>New farmer registration: <strong>Maria Santos</strong></p>
                                        <span class="notification-time">10 minutes ago</span>
                                    </div>
                                </li>
                                <li class="notification-item">
                                    <div class="notification-icon warning"><i class="fas fa-exclamation-triangle"></i></div>
                                    <div class="notification-content">
                                        <p>Low stock alert: <strong>Organic Rice</strong></p>
                                        <span class="notification-time">1 hour ago</span>
                                    </div>
                                </li>
                                <li class="notification-item">
                                    <div class="notification-icon success"><i class="fas fa-check-circle"></i></div>
                                    <div class="notification-content">
                                        <p>Order #23891 successfully delivered</p>
                                        <span class="notification-time">2 hours ago</span>
                                    </div>
                                </li>
                                <li class="notification-item">
                                    <div class="notification-icon info"><i class="fas fa-info-circle"></i></div>
                                    <div class="notification-content">
                                        <p>System update scheduled for tonight</p>
                                        <span class="notification-time">5 hours ago</span>
                                    </div>
                                </li>
                                <li class="notification-item">
                                    <div class="notification-icon warning"><i class="fas fa-exclamation-circle"></i></div>
                                    <div class="notification-content">
                                        <p>Payment failed: <strong>Order #23885</strong></p>
                                        <span class="notification-time">Yesterday</span>
                                    </div>
                                </li>
                            </ul>
                            <div class="notification-footer"><a href="#notifications">View all notifications</a></div>
                        </div>
                    </div>
                    <div class="user-profile" id="userProfile">
                        <div class="user-avatar">AD</div>
                        <div class="user-info">
                            <div class="user-name">Admin Dashboard</div>
                            <span class="role-badge">Administrator</span>
                        </div>
                        <i class="fas fa-chevron-down dropdown-icon"></i>
                        <div class="user-dropdown" id="userDropdown">
                            <ul>
                                <li><a href="#profile"><i class="fas fa-user"></i> My Profile</a></li>
                                <li><a href="#settings"><i class="fas fa-cog"></i> Account Settings</a></li>
                                <li><a href="#help"><i class="fas fa-question-circle"></i> Help & Support</a></li>
                                <li class="divider"></li>
                                <li><a href="#" id="darkModeToggle"><i class="fas fa-moon"></i> <span id="themeText">Dark Mode</span></a></li>
                                <li class="divider"></li>
                                <li><a href="#" id="userDropdownLogout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Content -->
            <div class="dashboard-content">
                <div class="welcome-banner">
                    <div class="welcome-message">
                        <h1>Welcome back, Admin!</h1>
                        <p>Here's what's happening with your platform today.</p>
                    </div>
                    <div class="date-display" id="currentDate"></div>
                </div>

                <!-- Key Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon green"><i class="fas fa-users"></i></div>
                            <div class="metric-title">Registered Farmers</div>
                        </div>
                        <div class="metric-value" id="farmersCount">1,245</div>
                        <div class="metric-trend trend-up"><i class="fas fa-arrow-up"></i> <span id="farmersTrend">12%</span> this month</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon blue"><i class="fas fa-shopping-cart"></i></div>
                            <div class="metric-title">Active Buyers</div>
                        </div>
                        <div class="metric-value" id="buyersCount">892</div>
                        <div class="metric-trend trend-up"><i class="fas fa-arrow-up"></i> <span id="buyersTrend">8%</span> this month</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon yellow"><i class="fas fa-dollar-sign"></i></div>
                            <div class="metric-title">Monthly Revenue</div>
                        </div>
                        <div class="metric-value" id="revenueAmount">₱1,245,678</div>
                        <div class="metric-trend trend-up"><i class="fas fa-arrow-up"></i> <span id="revenueTrend">15%</span> this month</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon brown"><i class="fas fa-check-circle"></i></div>
                            <div class="metric-title">Fulfillment Rate</div>
                        </div>
                        <div class="metric-value" id="fulfillmentRate">95%</div>
                        <div class="metric-trend trend-up"><i class="fas fa-arrow-up"></i> <span id="fulfillmentTrend">5%</span> this month</div>
                    </div>
                </div>

                <!-- Platform Analytics -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">Platform Analytics</div>
                        <div class="section-actions">
                            <div class="dropdown time-filter">
                                <button class="btn btn-secondary dropdown-toggle" id="timeRangeBtn">
                                    <i class="fas fa-calendar"></i> <span id="timeRangeText">Last 30 Days</span> <i class="fas fa-chevron-down"></i>
                                </button>
                                <div class="dropdown-menu" id="timeRangeMenu">
                                    <a href="#" data-range="7">Last 7 Days</a>
                                    <a href="#" data-range="30" class="active">Last 30 Days</a>
                                    <a href="#" data-range="90">Last 90 Days</a>
                                    <a href="#" data-range="365">Last Year</a>
                                </div>
                            </div>
                            <button class="btn btn-primary" id="exportBtn"><i class="fas fa-download"></i> Export</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="growthChart"></canvas>
                        <div class="chart-loader" id="growthChartLoader">
                            <div class="spinner"></div>
                            <p>Loading data...</p>
                        </div>
                    </div>
                    <div class="charts-row">
                        <div class="chart-container">
                            <canvas id="regionChart"></canvas>
                            <div class="chart-loader" id="regionChartLoader">
                                <div class="spinner"></div>
                                <p>Loading data...</p>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="categoryChart"></canvas>
                            <div class="chart-loader" id="categoryChartLoader">
                                <div class="spinner"></div>
                                <p>Loading data...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title">Recent Activity</div>
                        <div class="section-actions">
                            <button class="btn btn-secondary" id="refreshActivityBtn"><i class="fas fa-sync-alt"></i> Refresh</button>
                        </div>
                    </div>
                    <div class="tabs">
                        <div class="tab active" data-tab="orders">Recent Orders</div>
                        <div class="tab" data-tab="users">New Users</div>
                        <div class="tab" data-tab="reviews">Latest Reviews</div>
                    </div>
                    <div class="tab-content" id="ordersTab">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Customer</th>
                                        <th>Products</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recentOrdersTable"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-content hidden" id="usersTab">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Email</th>
                                        <th>Type</th>
                                        <th>Location</th>
                                        <th>Registered</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recentUsersTable"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-content hidden" id="reviewsTab">
                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>User</th>
                                        <th>Rating</th>
                                        <th>Comment</th>
                                        <th>Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recentReviewsTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="footer">
                <div class="footer-content">
                    <p>© 2025 AgriGo. All rights reserved.</p>
                    <div class="footer-links">
                        <a href="#terms">Terms of Service</a>
                        <a href="#privacy">Privacy Policy</a>
                        <a href="#help">Help Center</a>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Utility Functions
            const $ = (selector) => document.querySelector(selector);
            const $$ = (selector) => document.querySelectorAll(selector);
            const toggleClass = (element, className) => element?.classList.toggle(className);
            const showToast = (message, type = "success", duration = 3000) => {
                const toastContainer = $("#toastContainer");
                const toast = document.createElement("div");
                toast.className = `toast toast-${type}`;
                toast.innerHTML = `<span>${message}</span><i class="fas fa-times" onclick="this.parentElement.remove()"></i>`;
                toastContainer.appendChild(toast);
                setTimeout(() => toast.remove(), duration);
            };

            // Sidebar Toggle
            const menuToggle = $("#menu-toggle");
            const sidebar = $("#sidebar");
            const mainContent = $("#main-content");
            const overlay = $("#overlay");

            if (menuToggle && sidebar && mainContent) {
                menuToggle.addEventListener("click", () => {
                    toggleClass(sidebar, "sidebar-collapsed");
                    toggleClass(mainContent, "main-content-expanded");
                    const icon = menuToggle.querySelector("i");
                    icon.classList.toggle("fa-chevron-left");
                    icon.classList.toggle("fa-chevron-right");
                });
            }

            // Mobile Menu Toggle
            const mobileMenuToggle = $("#mobile-menu-toggle");
            const sidebarToggleMobile = $(".sidebar-toggle-mobile");

            const toggleMobileSidebar = () => {
                toggleClass(sidebar, "active");
                toggleClass(overlay, "active");
            };

            if (mobileMenuToggle) mobileMenuToggle.addEventListener("click", toggleMobileSidebar);
            if (sidebarToggleMobile) sidebarToggleMobile.addEventListener("click", toggleMobileSidebar);
            if (overlay) overlay.addEventListener("click", toggleMobileSidebar);

            // Dark Mode Toggle
            const darkModeToggle = $("#darkModeToggle");
            const themeText = $("#themeText");
            if (darkModeToggle) {
                const toggleDarkMode = () => {
                    const isDark = document.body.classList.toggle("dark-mode");
                    localStorage.setItem("darkMode", isDark);
                    themeText.textContent = isDark ? "Light Mode" : "Dark Mode";
                    updateCharts();
                };
                darkModeToggle.addEventListener("click", toggleDarkMode);
                if (localStorage.getItem("darkMode") === "true") toggleDarkMode();
            }

            // Notification Dropdown
            const notificationIcon = $("#notificationIcon");
            const notificationDropdown = $("#notificationDropdown");
            if (notificationIcon && notificationDropdown) {
                notificationIcon.addEventListener("click", (e) => {
                    e.stopPropagation();
                    toggleClass(notificationDropdown, "show");
                });
                document.addEventListener("click", (e) => {
                    if (!notificationIcon.contains(e.target)) notificationDropdown.classList.remove("show");
                });
            }

            // User Profile Dropdown
            const userProfile = $("#userProfile");
            const userDropdown = $("#userDropdown");
            if (userProfile && userDropdown) {
                userProfile.addEventListener("click", (e) => {
                    e.stopPropagation();
                    toggleClass(userDropdown, "show");
                });
                document.addEventListener("click", (e) => {
                    if (!userProfile.contains(e.target)) userDropdown.classList.remove("show");
                });
            }

            // Logout Functionality
            const userDropdownLogout = $("#userDropdownLogout");
            if (userDropdownLogout) userDropdownLogout.addEventListener("click", (e) => {
                e.preventDefault();
                showToast("Logged out successfully!", "success");
                setTimeout(() => window.location.href = "/login", 2000);
            });

            // Current Date
            const currentDate = $("#currentDate");
            if (currentDate) {
                currentDate.textContent = new Date().toLocaleDateString("en-US", { weekday: "long", year: "numeric", month: "long", day: "numeric" });
            }

            // Simulated Data
            const dashboardData = {
                growth: {
                    "7": { labels: ["Mar 25", "Mar 26", "Mar 27", "Mar 28", "Mar 29", "Mar 30", "Mar 31"], data: [500, 520, 510, 540, 580, 600, 620] },
                    "30": { labels: ["Mar 1", "Mar 8", "Mar 15", "Mar 22", "Mar 29"], data: [2000, 2100, 2200, 2300, 2450] },
                    "90": { labels: ["Jan", "Feb", "Mar"], data: [6000, 6200, 6500] },
                    "365": { labels: ["Q1", "Q2", "Q3", "Q4"], data: [24000, 25000, 26000, 27000] }
                },
                region: { labels: ["Luzon", "Visayas", "Mindanao"], data: [60, 25, 15] },
                category: { labels: ["Crops", "Livestock", "Tools"], data: [50, 30, 20] },
                orders: [
                    { id: "23891", customer: "Juan Dela Cruz", products: "Rice Seeds", total: "₱5,000", status: "Delivered", date: "Mar 31, 2025" },
                    { id: "23890", customer: "Maria Santos", products: "Fertilizer", total: "₱2,500", status: "Pending", date: "Mar 30, 2025" }
                ],
                users: [
                    { id: "U001", name: "Maria Santos", email: "maria@example.com", type: "Farmer", location: "Quezon", registered: "Mar 31, 2025" },
                    { id: "U002", name: "Pedro Reyes", email: "pedro@example.com", type: "Buyer", location: "Manila", registered: "Mar 30, 2025" }
                ],
                reviews: [
                    { product: "Rice Seeds", user: "Juan Dela Cruz", rating: 5, comment: "Great quality!", date: "Mar 31, 2025" },
                    { product: "Fertilizer", user: "Maria Santos", rating: 4, comment: "Effective product.", date: "Mar 30, 2025" }
                ]
            };

            // Charts
            let growthChart, regionChart, categoryChart;
            const chartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { 
                    legend: { position: "bottom", labels: { color: document.body.classList.contains("dark-mode") ? "#e0e0e0" : "#424242" } },
                    tooltip: { backgroundColor: 'rgba(0, 0, 0, 0.8)', titleColor: '#fff', bodyColor: '#fff' }
                }
            };

            const updateCharts = () => {
                const isDark = document.body.classList.contains("dark-mode");
                const textColor = isDark ? "#e0e0e0" : "#424242";
                const gridColor = isDark ? "#333333" : "#e0e0e0";
                const range = $("#timeRangeText").textContent.includes("7") ? "7" : $("#timeRangeText").textContent.includes("30") ? "30" : $("#timeRangeText").textContent.includes("90") ? "90" : "365";

                if (growthChart) growthChart.destroy();
                growthChart = new Chart($("#growthChart"), {
                    type: "line",
                    data: {
                        labels: dashboardData.growth[range].labels,
                        datasets: [{
                            label: "Platform Growth",
                            data: dashboardData.growth[range].data,
                            borderColor: "#2e7d32",
                            backgroundColor: "rgba(46, 125, 50, 0.1)",
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        ...chartOptions,
                        scales: { 
                            y: { beginAtZero: true, ticks: { color: textColor }, grid: { color: gridColor } }, 
                            x: { ticks: { color: textColor }, grid: { color: gridColor } } 
                        }
                    }
                });

                if (regionChart) regionChart.destroy();
                regionChart = new Chart($("#regionChart"), {
                    type: "doughnut",
                    data: {
                        labels: dashboardData.region.labels,
                        datasets: [{ data: dashboardData.region.data, backgroundColor: ["#4fc3f7", "#2e7d32", "#fbc02d"], borderWidth: 0 }]
                    },
                    options: { ...chartOptions, cutout: "70%" }
                });

                if (categoryChart) categoryChart.destroy();
                categoryChart = new Chart($("#categoryChart"), {
                    type: "bar",
                    data: {
                        labels: dashboardData.category.labels,
                        datasets: [{ label: "Categories", data: dashboardData.category.data, backgroundColor: "#2e7d32", borderRadius: 4 }]
                    },
                    options: {
                        ...chartOptions,
                        scales: { 
                            y: { beginAtZero: true, ticks: { color: textColor }, grid: { color: gridColor } }, 
                            x: { ticks: { color: textColor }, grid: { color: gridColor } } 
                        }
                    }
                });

                setTimeout(() => {
                    $("#growthChartLoader").style.display = "none";
                    $("#regionChartLoader").style.display = "none";
                    $("#categoryChartLoader").style.display = "none";
                }, 1000);
            };

            updateCharts();

            // Time Range Filter
            const timeRangeBtn = $("#timeRangeBtn");
            const timeRangeMenu = $("#timeRangeMenu");
            if (timeRangeBtn && timeRangeMenu) {
                timeRangeBtn.addEventListener("click", () => toggleClass(timeRangeMenu, "show"));
                timeRangeMenu.querySelectorAll("a").forEach(link => {
                    link.addEventListener("click", (e) => {
                        e.preventDefault();
                        const range = link.getAttribute("data-range");
                        $("#timeRangeText").textContent = range === "7" ? "Last 7 Days" : range === "30" ? "Last 30 Days" : range === "90" ? "Last 90 Days" : "Last Year";
                        timeRangeMenu.querySelectorAll("a").forEach(a => a.classList.remove("active"));
                        link.classList.add("active");
                        toggleClass(timeRangeMenu, "show");
                        updateCharts();
                    });
                });
            }

            // Export Functionality
            $("#exportBtn").addEventListener("click", () => {
                const csv = [
                    "Growth Chart\n" + growthChart.data.labels.map((label, i) => `${label},${growthChart.data.datasets[0].data[i]}`).join("\n"),
                    "\nRegion Chart\n" + regionChart.data.labels.map((label, i) => `${label},${regionChart.data.datasets[0].data[i]}`).join("\n"),
                    "\nCategory Chart\n" + categoryChart.data.labels.map((label, i) => `${label},${categoryChart.data.datasets[0].data[i]}`).join("\n")
                ].join("\n");
                const blob = new Blob([csv], { type: "text/csv" });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "dashboard_data.csv";
                a.click();
                window.URL.revokeObjectURL(url);
                showToast("Data exported successfully!", "success");
            });

            // Tab Switching
            const tabs = $$(".tab");
            tabs.forEach(tab => {
                tab.addEventListener("click", () => {
                    tabs.forEach(t => t.classList.remove("active"));
                    tab.classList.add("active");
                    $$(".tab-content").forEach(content => content.classList.add("hidden"));
                    $(`#${tab.getAttribute("data-tab")}Tab`).classList.remove("hidden");
                });
            });

            // Populate Tables
            const populateTable = (tableId, data, fields) => {
                const tbody = $(`#${tableId}`);
                tbody.innerHTML = "";
                data.forEach(item => {
                    const tr = document.createElement("tr");
                    fields.forEach(field => {
                        const td = document.createElement("td");
                        td.textContent = item[field];
                        tr.appendChild(td);
                    });
                    const actionTd = document.createElement("td");
                    actionTd.innerHTML = `<i class="fas fa-eye action-btn" title="View"></i>`;
                    tr.appendChild(actionTd);
                    tbody.appendChild(tr);
                });
            };

            populateTable("recentOrdersTable", dashboardData.orders, ["id", "customer", "products", "total", "status", "date"]);
            populateTable("recentUsersTable", dashboardData.users, ["id", "name", "email", "type", "location", "registered"]);
            populateTable("recentReviewsTable", dashboardData.reviews, ["product", "user", "rating", "comment", "date"]);

            // Refresh Activity
            $("#refreshActivityBtn").addEventListener("click", () => {
                showToast("Refreshing data...", "info");
                setTimeout(() => {
                    populateTable("recentOrdersTable", dashboardData.orders, ["id", "customer", "products", "total", "status", "date"]);
                    populateTable("recentUsersTable", dashboardData.users, ["id", "name", "email", "type", "location", "registered"]);
                    populateTable("recentReviewsTable", dashboardData.reviews, ["product", "user", "rating", "comment", "date"]);
                    showToast("Data refreshed!", "success");
                }, 1000);
            });

            // Search Functionality
            const searchInput = $("#searchInput");
            if (searchInput) {
                searchInput.addEventListener("input", () => {
                    const query = searchInput.value.toLowerCase();
                    ["recentOrdersTable", "recentUsersTable", "recentReviewsTable"].forEach(tableId => {
                        const rows = $$(`#${tableId} tr`);
                        rows.forEach(row => {
                            const text = row.textContent.toLowerCase();
                            row.style.display = text.includes(query) ? "" : "none";
                        });
                    });
                });
            }
        });
    </script>
</body>
</html>